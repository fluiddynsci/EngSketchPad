<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AVL Analysis Interface Module (AIM): AVL AIM Examples</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AVL Analysis Interface Module (AIM)
   </div>
   <div id="projectbrief">AVL Analysis Interface Module (AIM)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AVL AIM Examples </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example contains a set of *.csm and pyCAPS (*.py) inputs that uses the AVL AIM. A user should have knowledge on the generation of parametric geometry in Engineering Sketch Pad (ESP) before attempting to integrate with any AIM. Specifically, this example makes use of Design Parameters, Set Parameters, User Defined Primitive (UDP) and attributes in ESP.</p>
<p>The follow code details the process in a *.csm file that generates three airfoil sections to create a wing. Note to execute in serveCSM a dictionary file must be included "serveCSM $ESP_ROOT/CAPSexamples/csmData/avlWing.csm"</p>
<p>The CSM script generates Bodies which are designed to be used by specific AIMs. The AIMs that the Body is designed for is communicated to the CAPS framework via the capsAIM string attribute. This is a semicolon-separated string with the list of AIM names. Thus, the CSM author can give a clear indication to which AIMs should use the Body. In this example, the list contains only the avlAIM: </p><div class="fragment"><div class="line">attribute capsAIM     $avlAIM</div></div><!-- fragment --><p> Next we will define the design parameters to define the wing cross section and planform. </p><div class="fragment"><div class="line">despmtr   thick     0.12      frac of local chord</div><div class="line">despmtr   camber    0.04      frac of loacl chord</div><div class="line">despmtr   area      10.0      Planform area of the full span wing</div><div class="line">despmtr   aspect    6.00      Span^2/Area</div><div class="line">despmtr   taper     0.60      TipChord/RootChord</div><div class="line">despmtr   sweep     20.0      1/4 Chord Sweep</div><div class="line">despmtr   washout  -5.00      deg (negative is down at tip)</div><div class="line">despmtr   dihedral  4.00      deg</div></div><!-- fragment --><p> The design parameters will then be used to set parameters for use internally to create geometry. </p><div class="fragment"><div class="line">set       span      sqrt(aspect*area)</div><div class="line">set       croot     2*area/span/(1+taper)</div><div class="line">set       ctip      croot*taper</div><div class="line">set       dxtip     (croot-ctip)/4+span/2*tand(sweep)</div><div class="line">set       dztip     span/2*tand(dihedral)</div></div><!-- fragment --><p> Finally, the airfoils are created using the User Defined Primitive (UDP) naca. The inputs used for this example to the UDP are Thickness and Camber. Cross sections are in the X-Y plane and are rotated to the X-Z plane. Reference quantities must exist on any body, otherwise AVL defaults to 1.0 for Area, Span, Chord and 0.0 for X,Y,Z moment References</p>
<div class="fragment"><div class="line"># left tip</div><div class="line">udprim    naca      Thickness thick     Camber    camber</div><div class="line">attribute capsGroup    $Wing</div><div class="line">attribute capsReferenceArea  area</div><div class="line">attribute capsReferenceSpan  span</div><div class="line">attribute capsReferenceChord croot</div><div class="line">attribute capsReferenceX     croot/4</div><div class="line">scale     ctip</div><div class="line">rotatex   90        0         0</div><div class="line">rotatey   washout   0         ctip/4</div><div class="line">translate dxtip    -span/2    dztip</div><div class="line"></div><div class="line"># root</div><div class="line">udprim    naca      Thickness thick     Camber    camber</div><div class="line">attribute capsGroup    $Wing</div><div class="line">rotatex   90        0         0</div><div class="line">scale     croot</div><div class="line"></div><div class="line"># right tip</div><div class="line">udprim    naca      Thickness thick     Camber    camber</div><div class="line">attribute capsGroup    $Wing</div><div class="line">scale     ctip</div><div class="line">rotatex   90        0         0</div><div class="line">rotatey   washout   0         ctip/4</div><div class="line">translate dxtip     span/2    dztip</div></div><!-- fragment --><p> An example pyCAPS script that uses the above csm file to run AVL is as follows.</p>
<p>First the pyCAPS and os module needs to be imported. </p><div class="fragment"><div class="line">import pyCAPS</div><div class="line"></div><div class="line"><span class="keyword">import</span> os</div></div><!-- fragment --><p> Note if your Python major version is less than 3 (i.e. Python 2.7). The following statement should also be included so that print statements work correctly.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</div></div><!-- fragment --><p> Once the modules have been loaded the problem needs to be initiated.</p>
<div class="fragment"><div class="line">myProblem = pyCAPS.capsProblem()</div></div><!-- fragment --><p> Next the *.csm file is loaded and design parameter is changed - area in the geometry. Any despmtr from the avlWing.csm file is available inside the pyCAPS script. They are: thick, camber, area, aspect, taper, sweep, washout, dihedral...</p>
<div class="fragment"><div class="line">geometryScript = os.path.join(<span class="stringliteral">&quot;..&quot;</span>,<span class="stringliteral">&quot;csmData&quot;</span>,<span class="stringliteral">&quot;avlWing.csm&quot;</span>)</div><div class="line">myGeometry = myProblem.loadCAPS(geometryScript, verbosity=args.verbosity)</div><div class="line"></div><div class="line">myGeometry.setGeometryVal(<span class="stringliteral">&quot;area&quot;</span>, 10.0)</div></div><!-- fragment --><p> The AVL AIM is then loaded with: </p><div class="fragment"><div class="line">myAnalysis = myProblem.loadAIM(aim = <span class="stringliteral">&quot;avlAIM&quot;</span>,</div><div class="line">                               analysisDir = workDir)</div></div><!-- fragment --><p> After the AIM is loaded the Mach number and angle of attack are set, though all <a class="el" href="aimInputsAVL.html">AIM Inputs</a> are available. </p><div class="fragment"><div class="line">myAnalysis.setAnalysisVal(<span class="stringliteral">&quot;Mach&quot;</span>, 0.5)</div><div class="line">myAnalysis.setAnalysisVal(<span class="stringliteral">&quot;Alpha&quot;</span>, 1.0)</div><div class="line">myAnalysis.setAnalysisVal(<span class="stringliteral">&quot;Beta&quot;</span>, 0.0)</div><div class="line"></div><div class="line">wing = {<span class="stringliteral">&quot;groupName&quot;</span>    : <span class="stringliteral">&quot;Wing&quot;</span>, <span class="comment"># Notice Wing is the value for the capsGroup attribute</span></div><div class="line">        <span class="stringliteral">&quot;numChord&quot;</span>     : 8,</div><div class="line">        <span class="stringliteral">&quot;spaceChord&quot;</span>   : 1.0,</div><div class="line">        <span class="stringliteral">&quot;numSpanTotal&quot;</span> : 24,</div><div class="line">        <span class="stringliteral">&quot;spaceSpan&quot;</span>    : 1.0}</div><div class="line"></div><div class="line">myAnalysis.setAnalysisVal(<span class="stringliteral">&quot;AVL_Surface&quot;</span>, [(<span class="stringliteral">&quot;Wing&quot;</span>, wing)])</div><div class="line"></div></div><!-- fragment --><p> Once all the inputs have been set, preAnalysis needs to be executed. During this operation, all the necessary files to run AVL are generated and placed in the analysis working directory (analysisDir) </p><div class="fragment"><div class="line">myAnalysis.preAnalysis()</div></div><!-- fragment --><p> An OS system call is then made from Python to execute AVL. </p><div class="fragment"><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;Running AVL&quot;</span>)</div><div class="line">currentDirectory = os.getcwd() <span class="comment"># Get our current working directory</span></div><div class="line">os.chdir(myAnalysis.analysisDir) <span class="comment"># Move into test directory</span></div><div class="line"></div><div class="line">os.system(<span class="stringliteral">&quot;avl caps &lt; avlInput.txt &gt; avlOutput.txt&quot;</span>);</div><div class="line"></div><div class="line">os.chdir(currentDirectory) <span class="comment"># Move back to working directory</span></div></div><!-- fragment --><p> A call to postAnalysis is then made to check to see if AVL executed successfully and the expected files were generated. </p><div class="fragment"><div class="line">myAnalysis.postAnalysis()</div></div><!-- fragment --><p> Similar to the AIM inputs, after the execution of AVL and postAnalysis any of the AIM's output variables (<a class="el" href="aimOutputsAVL.html">AIM Outputs</a>) are readily available; for example, </p><div class="fragment"><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CXtot  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CXtot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CYtot  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CYtot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CZtot  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CZtot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;Cltot  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;Cltot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;Cmtot  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;Cmtot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;Cntot  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;Cntot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;Cl&#39;tot &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;Cl&#39;tot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;Cn&#39;tot &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;Cn&#39;tot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CLtot  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CLtot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CDtot  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CDtot&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CDvis  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CDvis&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CLff   &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CLff&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CYff   &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CYff&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CDind  &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CDind&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;CDff   &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;CDff&quot;</span>))</div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;e      &quot;</span>, myAnalysis.getAnalysisOutVal(<span class="stringliteral">&quot;e&quot;</span>))</div></div><!-- fragment --><p> results in </p><div class="fragment"><div class="line">CXtot   -0.00033</div><div class="line">CYtot   1e-05</div><div class="line">CZtot   -0.30016</div><div class="line">Cltot   -0.0</div><div class="line">Cmtot   -0.19468</div><div class="line">Cntot   -1e-05</div><div class="line">Cl<span class="stringliteral">&#39;tot  -0.0</span></div><div class="line"><span class="stringliteral">Cn&#39;</span>tot  -1e-05</div><div class="line">CLtot   0.30011</div><div class="line">CDtot   0.00557</div><div class="line">CDvis   0.0</div><div class="line">CLff    0.29968</div><div class="line">CYff    0.0</div><div class="line">CDind   0.00557</div><div class="line">CDff    0.00492</div><div class="line">e       0.9691</div></div><!-- fragment --><p>Additionally, besides making a call to the AIM outputs, sensitivity values may be obtained in the following manner, </p><div class="fragment"><div class="line">sensitivity = myAnalysis.getSensitivity(<span class="stringliteral">&quot;Alpha&quot;</span>, <span class="stringliteral">&quot;CLtot&quot;</span>)</div></div><!-- fragment --><p> The avlAIM supports the control surface modeling functionality inside AVL. Trailing edge control surfaces can be added to the above example by making use of the vlmControlName attribute (see <a class="el" href="attributeAVL.html">AIM Attributes</a> regarding the attribution specifics). To add a <b>RightFlap</b> and <b>LeftFlap</b> to the previous example *.csm file the naca UDP entries are augmented with the following attributes.</p>
<div class="fragment"><div class="line"><span class="comment"># left tip</span></div><div class="line">udprim    naca      Thickness thick     Camber    camber</div><div class="line">attribute vlmControl_LeftFlap 80 <span class="comment"># Hinge line is at 80% of the chord</span></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment"># root</span></div><div class="line">udprim    naca      Thickness thick     Camber    camber</div><div class="line">attribute vlmControl_LeftFlap 80 <span class="comment"># Hinge line is at 80% of the chord</span></div><div class="line">attribute vlmControl_RightFlap 80 <span class="comment"># Hinge line is at 80% of the chord</span></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment"># right tip</span></div><div class="line">udprim    naca      Thickness thick     Camber    camber</div><div class="line">attribute vlmControl_RightFlap 80 <span class="comment"># Hinge line is at 80% of the chord</span></div><div class="line">...</div></div><!-- fragment --><p>Note how the root airfoil contains two attributes for both the left and right flaps.</p>
<p>In the pyCAPS script the <a class="el" href="aimInputsAVL.html">AIM Inputs</a>, <b>AVL_Control</b>, must be defined. </p><div class="fragment"><div class="line">flap = {<span class="stringliteral">&quot;controlGain&quot;</span>     : 0.5,</div><div class="line">        <span class="stringliteral">&quot;deflectionAngle&quot;</span> : 10.0}</div><div class="line"></div><div class="line"> myAnalysis.setAnalysisVal(<span class="stringliteral">&quot;AVL_Control&quot;</span>, [(<span class="stringliteral">&quot;LeftFlap&quot;</span>, flap), (<span class="stringliteral">&quot;RightFlap&quot;</span>, flap)])</div></div><!-- fragment --><p>Notice how the information defined in the <b>flap</b> variable is assigned to the vlmControl<b>Name</b> portion of the attributes added to the *.csm file. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 28 2020 06:21:12 for AVL Analysis Interface Module (AIM) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
