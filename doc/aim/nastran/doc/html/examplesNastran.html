<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nastran Analysis Interface Module (AIM): Nastran AIM Examples</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Nastran Analysis Interface Module (AIM)
   </div>
   <div id="projectbrief">Natran Analysis Interface Module (AIM)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Nastran AIM Examples </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section introduces the user to the Nastran AIM via examples. These examples are intended to introduce the user to nastran functionality. They make use of the information found in the <a class="el" href="aimInputsNastran.html">AIM Inputs</a>, <a class="el" href="aimOutputsNastran.html">AIM Outputs</a> and <a class="el" href="attributeNastran.html">Nastran AIM attributes</a> sections.</p>
<h1><a class="anchor" id="nastranSingleLoadEx"></a>
Single Load Case Example</h1>
<p>The first example is a simple three bar truss structure. This example is intended to demonstrate the use of all the attributes in addition to introducing the user to the Nastran AIM.</p>
<div class="image">
<img src="threeBar.png" alt="threeBar.png"/>
<div class="caption">
Three Bar Truss</div></div>
 <p>The follow code details the process in a *.csm file that generates a three bar truss. Note to execute in serveCSM a dictionary file must be included</p>
<ul>
<li><code>serveCSM feaThreeBar.csm</code></li>
</ul>
<p>The CSM script generates Bodies which are designed to be used by specific AIMs. The AIMs that the Body is designed for is communicated to the CAPS framework via the “capsAIM” string attribute. This is a semicolon-separated string with the list of AIM names. Thus, the CSM author can give a clear indication to which AIMs should use the Body. In this example, the list contains the structural finite element analysis tools that can analyze the body: </p><div class="fragment"><div class="line">attribute capsAIM $nastranAIM;astrosAIM;mystranAIM</div></div><!-- fragment --><p> Next we will define the design parameters to define the wing cross section and planform. Notice that the despmtr entries have a dimension input that must be defined for inputs with a length greater than one. </p><div class="fragment"><div class="line">dimension   X   1 4 1</div><div class="line">dimension   Y   1 4 1</div><div class="line">dimension   Z   1 4 1</div><div class="line"></div><div class="line">despmtr X   &quot;-10; 0; 10;   0;&quot;</div><div class="line">despmtr Y   &quot;  0; 0;  0; -10;&quot;</div><div class="line">despmtr Z   &quot;  0; 0;  0;   0;&quot;</div></div><!-- fragment --><p> Next the three bar truss is defined using the points defined in the <code>despmtr</code> entries. Notice that the middle edge is "drawn" twice. This is done because OpenCASCADE cannot perform boolean operations on non-manifold (not closed) wire bodies. </p><div class="fragment"><div class="line">skbeg  X[1,1] Y[1,1] Z[1,1]</div><div class="line">linseg X[1,4] Y[1,4] Z[1,4]</div><div class="line">linseg X[1,2] Y[1,2] Z[1,2]</div><div class="line">linseg X[1,4] Y[1,4] Z[1,4]</div><div class="line">linseg X[1,3] Y[1,3] Z[1,3]</div><div class="line">skend</div></div><!-- fragment --><p> In this section the edge elements are attributed with a <code>capsGroup</code> string <code>$bar1</code> etc. so information can be assigned to them. Notice the <code>capsIgnore</code> attribute assigned to one of the overlapping "middle" edges defined in the geometry above. The reason for this is discussed in the <a class="el" href="attributeNastran.html">Nastran AIM attributes</a> section. </p><div class="fragment"><div class="line">select edge 1</div><div class="line">attribute capsGroup $bar1</div><div class="line">select edge 2</div><div class="line">attribute capsGroup $bar2</div><div class="line">select edge 3</div><div class="line">attribute capsIgnore $multipleEdge</div><div class="line">select edge 4</div><div class="line">attribute capsGroup $bar3</div></div><!-- fragment --><p> Finally, the nodes are attributed. In this case, the three nodes across the top are given the same <code>capsConstraint</code> name. They could be assigned a different name allowing the user to define a different boundary condition at each location. The lower node is given a different <code>capsLoad</code> name so a load can be applied. </p><div class="fragment"><div class="line">select node 1</div><div class="line">attribute capsConstraint $boundary</div><div class="line">select node 2</div><div class="line">attribute capsLoad $force</div><div class="line">select node 3</div><div class="line">attribute capsConstraint $boundary</div><div class="line">select node 4</div><div class="line">attribute capsConstraint $boundary</div></div><!-- fragment --><p> The following input defines a pyCAPS input that can be used along with the above *.csm input to create a nastran input. First the pyCAPS and os module needs to be imported. </p><div class="fragment"><div class="line"><span class="comment"># Import pyCAPS class file</span></div><div class="line"><span class="keyword">from</span> pyCAPS <span class="keyword">import</span> capsProblem</div><div class="line"></div><div class="line"><span class="comment"># Import os module</span></div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> argparse</div></div><!-- fragment --><p> Note if your Python major version is less than 3 (i.e. Python 2.7) the following statement should also be included so that print statements work correctly.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</div></div><!-- fragment --><p> Once the modules have been loaded the problem needs to be initiated.</p>
<div class="fragment"><div class="line"><span class="comment"># Initialize capsProblem object</span></div><div class="line">myProblem = capsProblem()</div></div><!-- fragment --><p> Next the *.csm file is loaded. Though not shown in this example the user has access to the X, Y and Z despmtr inputs from this pyCAPS script.</p>
<div class="fragment"><div class="line"><span class="comment"># Load CSM file</span></div><div class="line">geometryScript = os.path.join(<span class="stringliteral">&quot;..&quot;</span>,<span class="stringliteral">&quot;csmData&quot;</span>,<span class="stringliteral">&quot;feaThreeBar.csm&quot;</span>)</div><div class="line">myProblem.loadCAPS(geometryScript, verbosity=args.verbosity)</div></div><!-- fragment --><p> The Nastran AIM is then loaded with: </p><div class="fragment"><div class="line"><span class="comment"># Load nastran aim</span></div><div class="line">nastranAIM = myProblem.loadAIM(aim = <span class="stringliteral">&quot;nastranAIM&quot;</span>,</div><div class="line">                               altName = <span class="stringliteral">&quot;nastran&quot;</span>,</div><div class="line">                               analysisDir= os.path.join(str(args.workDir[0]), <span class="stringliteral">&quot;NastranThreeBar&quot;</span>),</div><div class="line">                               capsIntent = <span class="stringliteral">&quot;STRUCTURE&quot;</span>)</div></div><!-- fragment --><p> After the AIM is loaded some of the inputs to the AIM are defined. A full list of options can be found in the <a class="el" href="aimInputsNastran.html">AIM Inputs</a> section. In this case the <code>Proj_Name</code> is entered. The project name becomes the Nastran input file names. Two are create <code>projectName.bdf</code> and <code>projectName.dat</code>. The <code>*.bdf</code> file contains the grid and connectivity information. The data file contains the case control and other bulk data inputs required by Nastran. The input format is selected as <code>Free</code> and large field format is used when the option is available. This is most likely in the GRID entries only. Additionally the analysis type selected is <code>Static</code>. The maximum and minimum points that can be placed along an edge is set to be two. This ensures that each edge shown in the figure will be represented by a single finite element bar. </p><div class="fragment"><div class="line"><span class="comment"># Set project name so a mesh file is generated</span></div><div class="line">projectName = <span class="stringliteral">&quot;threebar_nastran_Test&quot;</span></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Proj_Name&quot;</span>, projectName)</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;File_Format&quot;</span>, <span class="stringliteral">&quot;Free&quot;</span>)</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Mesh_File_Format&quot;</span>, <span class="stringliteral">&quot;Large&quot;</span>)</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Edge_Point_Max&quot;</span>, 2);</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Edge_Point_Min&quot;</span>, 2);</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Analysis_Type&quot;</span>, <span class="stringliteral">&quot;Static&quot;</span>);</div></div><!-- fragment --><p> Next the material inputs, property selection, constraints and loads are defined. First materials are defined. </p><div class="fragment"><div class="line">madeupium    = {<span class="stringliteral">&quot;materialType&quot;</span> : <span class="stringliteral">&quot;isotropic&quot;</span>,</div><div class="line">                <span class="stringliteral">&quot;youngModulus&quot;</span> : 1.0E7 ,</div><div class="line">                <span class="stringliteral">&quot;poissonRatio&quot;</span> : .33,</div><div class="line">                <span class="stringliteral">&quot;density&quot;</span>      : 0.1}</div><div class="line"></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Material&quot;</span>, [(<span class="stringliteral">&quot;Madeupium&quot;</span>, madeupium)])</div></div><!-- fragment --><p> Next these materials are used in the property definition. In this case two <code>bar</code> type properties are assigned to the edges. The outer bars have a property with a different area then the center bar. Note the relationship of <code>bar1</code> etc. between this pyCAPS input and the *,csm input previously shown. </p><div class="fragment"><div class="line">rod  =   {<span class="stringliteral">&quot;propertyType&quot;</span>      : <span class="stringliteral">&quot;Rod&quot;</span>,</div><div class="line">          <span class="stringliteral">&quot;material&quot;</span>          : <span class="stringliteral">&quot;Madeupium&quot;</span>,</div><div class="line">          <span class="stringliteral">&quot;crossSecArea&quot;</span>      : 1.0}</div><div class="line"></div><div class="line">rod2  =   {<span class="stringliteral">&quot;propertyType&quot;</span>     : <span class="stringliteral">&quot;Rod&quot;</span>,</div><div class="line">          <span class="stringliteral">&quot;material&quot;</span>          : <span class="stringliteral">&quot;Madeupium&quot;</span>,</div><div class="line">          <span class="stringliteral">&quot;crossSecArea&quot;</span>      : 2.0}</div><div class="line"></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Property&quot;</span>, [(<span class="stringliteral">&quot;bar1&quot;</span>, rod),</div><div class="line">                                       (<span class="stringliteral">&quot;bar2&quot;</span>, rod2),</div><div class="line">                                       (<span class="stringliteral">&quot;bar3&quot;</span>, rod)])</div></div><!-- fragment --><p> Next the three nodes with <code>capsConstraint</code> boundary are constrained in all six degrees of freedom. </p><div class="fragment"><div class="line">constraint = {<span class="stringliteral">&quot;groupName&quot;</span>         : [<span class="stringliteral">&quot;boundary&quot;</span>],</div><div class="line">              <span class="stringliteral">&quot;dofConstraint&quot;</span>     : 123456}</div><div class="line"></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Constraint&quot;</span>, (<span class="stringliteral">&quot;BoundaryCondition&quot;</span>, constraint))</div></div><!-- fragment --><p> Finally a load is applied the the node with the <code>capsLoad</code> force. </p><div class="fragment"><div class="line">load = {<span class="stringliteral">&quot;groupName&quot;</span>         : <span class="stringliteral">&quot;force&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;loadType&quot;</span>             : <span class="stringliteral">&quot;GridForce&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;forceScaleFactor&quot;</span>     : 20000.0,</div><div class="line">        <span class="stringliteral">&quot;directionVector&quot;</span>     : [0.8, -0.6, 0.0]}</div><div class="line"></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Load&quot;</span>, (<span class="stringliteral">&quot;appliedForce&quot;</span>, load ))</div></div><!-- fragment --><p> Finally an analysis case is defined that connects an analysis type to the load and constraint condition by name. </p><div class="fragment"><div class="line">value = {<span class="stringliteral">&quot;analysisType&quot;</span>         : <span class="stringliteral">&quot;Static&quot;</span>,</div><div class="line">         <span class="stringliteral">&quot;analysisConstraint&quot;</span>     : <span class="stringliteral">&quot;BoundaryCondition&quot;</span>,</div><div class="line">         <span class="stringliteral">&quot;analysisLoad&quot;</span>         : <span class="stringliteral">&quot;appliedForce&quot;</span>}</div><div class="line"></div><div class="line">myProblem.analysis[<span class="stringliteral">&quot;nastran&quot;</span>].setAnalysisVal(<span class="stringliteral">&quot;Analysis&quot;</span>, (<span class="stringliteral">&quot;SingleLoadCase&quot;</span>, value ))</div></div><!-- fragment --><p> Once all the inputs have been set, aimPreanalysis needs to be executed. During this operation all the necessary files to run Nastran are generated and placed in the analysis working directory (analysisDir) </p><div class="fragment"><div class="line">nastranAIM.preAnalysis()</div></div><!-- fragment --><p> An OS system call is then made from Python to execute Nastran. </p><div class="fragment"><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;\n\nRunning Nastran......&quot;</span>)</div><div class="line">currentDirectory = os.getcwd() <span class="comment"># Get our current working directory</span></div><div class="line">os.chdir(nastranAIM.analysisDir) <span class="comment"># Move into test directory</span></div><div class="line"><span class="keywordflow">if</span> (args.noAnalysis == <span class="keyword">False</span>): os.system(<span class="stringliteral">&quot;nastran old=no notify=no batch=no scr=yes sdirectory=./ &quot;</span> + projectName +  <span class="stringliteral">&quot;.dat&quot;</span>); <span class="comment"># Run Nastran via system call</span></div><div class="line">os.chdir(currentDirectory) <span class="comment"># Move back to working directory</span></div><div class="line"><span class="keywordflow">print</span> (<span class="stringliteral">&quot;Done running Nastran!&quot;</span>)</div></div><!-- fragment --><p> A call to aimPostanalysis is then made to check to see if AVL executed successfully and the expected files were generated. </p><div class="fragment"><div class="line">nastranAIM.postAnalysis()</div></div><!-- fragment --><p> Finally the session is closed </p><div class="fragment"><div class="line">myProblem.closeCAPS()</div></div><!-- fragment --><h1><a class="anchor" id="nastranMultipleLoadEx"></a>
Multiple Load/Boundary Case Example</h1>
<p>To create multiple load cases with different boundary conditions the pyCAPS input for constraints, and loads changes with respect to the <a class="el" href="examplesNastran.html#nastranSingleLoadEx">Single Load Case Example</a>. In addition an analysis section is added.</p>
<p>The constraint section may expand to allow multiple boundary conditions. In this way each load case can have a seperate boundary condition. If the input is left identical to the single load case example then the same boundary condition will be applied to each load case. </p><div class="fragment"><div class="line">constraints = []</div><div class="line"></div><div class="line">constraint = {<span class="stringliteral">&quot;groupName&quot;</span>         : [<span class="stringliteral">&quot;boundary&quot;</span>],</div><div class="line">              <span class="stringliteral">&quot;dofConstraint&quot;</span>     : 123456}</div><div class="line">tmp = ( <span class="stringliteral">&quot;conOne&quot;</span>, constraint )</div><div class="line">constraints.append( tmp )</div><div class="line"></div><div class="line">constraint = {<span class="stringliteral">&quot;groupName&quot;</span>         : [<span class="stringliteral">&quot;boundary&quot;</span>],</div><div class="line">              <span class="stringliteral">&quot;dofConstraint&quot;</span>     : 123}</div><div class="line">tmp = ( <span class="stringliteral">&quot;conTwo&quot;</span>, constraint )</div><div class="line">constraints.append( tmp )</div><div class="line"></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Constraint&quot;</span>, constraints)</div></div><!-- fragment --><p> Notice that an empty <code>constraints</code> variable has been defined. Then a <code>tmp</code> tuple is created with the name <code>"conOne"</code> paired with the dictionary <code>constraint</code>. This tuple is appended to the empty <code>constraints</code> variable. The process is repeated for the second boundary condition. Then the AIM input <code>"Constraint"</code> is defined with the information.</p>
<p>Next the load input is expanded to contain multiple cases. </p><div class="fragment"><div class="line">loads = []</div><div class="line"></div><div class="line">load = {<span class="stringliteral">&quot;groupName&quot;</span>         : <span class="stringliteral">&quot;force&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;loadType&quot;</span>          : <span class="stringliteral">&quot;GridForce&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;forceScaleFactor&quot;</span>  : 20000.0,</div><div class="line">        <span class="stringliteral">&quot;directionVector&quot;</span>   : [0.8, -0.6, 0.0]}</div><div class="line">loads.append( (<span class="stringliteral">&quot;loadOne&quot;</span>, load) )</div><div class="line"></div><div class="line">load = {<span class="stringliteral">&quot;groupName&quot;</span>         : <span class="stringliteral">&quot;force&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;loadType&quot;</span>          : <span class="stringliteral">&quot;GridForce&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;forceScaleFactor&quot;</span>  : 20000.0,</div><div class="line">        <span class="stringliteral">&quot;directionVector&quot;</span>   : [-0.8, -0.6, 0.0]}</div><div class="line">loads.append( (<span class="stringliteral">&quot;loadTwo&quot;</span>, load) )</div><div class="line"></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Load&quot;</span>, loads)</div></div><!-- fragment --><p> The process is identical to the constraint input.</p>
<p>Finally, analysis cases are defined that connect an analysis type to a load and constraint condition by name. </p><div class="fragment"><div class="line">analysisCases = []</div><div class="line"></div><div class="line">value = {<span class="stringliteral">&quot;analysisType&quot;</span>         : <span class="stringliteral">&quot;Static&quot;</span>,</div><div class="line">         <span class="stringliteral">&quot;analysisConstraint&quot;</span>     : <span class="stringliteral">&quot;conOne&quot;</span>,</div><div class="line">         <span class="stringliteral">&quot;analysisLoad&quot;</span>         : <span class="stringliteral">&quot;loadOne&quot;</span>}</div><div class="line">analysisCases.append( (<span class="stringliteral">&quot;analysisOne&quot;</span>, value ) )</div><div class="line"></div><div class="line">value = {<span class="stringliteral">&quot;analysisType&quot;</span>         : <span class="stringliteral">&quot;Static&quot;</span>,</div><div class="line">         <span class="stringliteral">&quot;analysisConstraint&quot;</span>     : <span class="stringliteral">&quot;conTwo&quot;</span>,</div><div class="line">         <span class="stringliteral">&quot;analysisLoad&quot;</span>         : <span class="stringliteral">&quot;loadTwo&quot;</span>}</div><div class="line">analysisCases.append( (<span class="stringliteral">&quot;analysisTwo&quot;</span>, value ) )</div><div class="line"></div><div class="line">myProblem.analysis[<span class="stringliteral">&quot;nastran&quot;</span>].setAnalysisVal(<span class="stringliteral">&quot;Analysis&quot;</span>, analysisCases)</div></div><!-- fragment --><p> Notice how the tuple names <code>"conOne"</code>, <code>"loadOne"</code> and <code>"analysisOne"</code> are all tied together. The <code>"analysisOne"</code> string also becomes the case control <code>LABEL</code> for the load case in the Nastran input file.</p>
<p>To finish the pyCAPS input the process starting with the pre-analysis input is identical to the <a class="el" href="examplesNastran.html#nastranSingleLoadEx">Single Load Case Example</a> input.</p>
<h1><a class="anchor" id="nastranModalEx"></a>
Modal Analysis Example Case</h1>
<p>To create input for a modal analysis a two simple changes are required to the <a class="el" href="examplesNastran.html#nastranSingleLoadEx">Single Load Case Example</a> input. The first change is to the <a class="el" href="aimInputsNastran.html">AIM Inputs</a> <code>Analysis_Type</code>. This input is the last input in the list below. </p><div class="fragment"><div class="line"><span class="comment"># Set project name so a mesh file is generated</span></div><div class="line">projectName = <span class="stringliteral">&quot;threebar_nastran_Test&quot;</span></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Proj_Name&quot;</span>, projectName)</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;File_Format&quot;</span>, <span class="stringliteral">&quot;Free&quot;</span>)</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Mesh_File_Format&quot;</span>, <span class="stringliteral">&quot;Large&quot;</span>)</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Edge_Point_Max&quot;</span>, 2);</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Edge_Point_Min&quot;</span>, 2);</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Analysis_Type&quot;</span>, <span class="stringliteral">&quot;Modal&quot;</span>);</div></div><!-- fragment --><p> A description of each of these inputs can be found in <a class="el" href="examplesNastran.html#nastranSingleLoadEx">Single Load Case Example</a>.</p>
<p>The second change is replacing the load case information with a definition for the <code>Analysis</code> AIM input. </p><div class="fragment"><div class="line">eigen = { <span class="stringliteral">&quot;extractionMethod&quot;</span>     : <span class="stringliteral">&quot;Lanczos&quot;</span>,</div><div class="line">          <span class="stringliteral">&quot;frequencyRange&quot;</span>       : [0, 10000],</div><div class="line">          <span class="stringliteral">&quot;numEstEigenvalue&quot;</span>     : 1,</div><div class="line">          <span class="stringliteral">&quot;numDesiredEigenvalue&quot;</span> : 10,</div><div class="line">          <span class="stringliteral">&quot;eigenNormaliztion&quot;</span>    : <span class="stringliteral">&quot;MASS&quot;</span>}</div><div class="line"></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Analysis&quot;</span>, (<span class="stringliteral">&quot;EigenAnalysis&quot;</span>, eigen))</div></div><!-- fragment --><p> This information defines the eigenvalue solver method and parameters and assigns it as an analysis case.</p>
<h1><a class="anchor" id="nastranOptEx"></a>
Optimization Example Case</h1>
<p>This section creates a design model out of the single load case example. The first change is an update to the <code>Analysis_Type</code> AIM Input to <code>StaticOpt</code>. </p><div class="fragment"><div class="line"><span class="comment"># Set project name so a mesh file is generated</span></div><div class="line">projectName = <span class="stringliteral">&quot;threebar_nastran_Test&quot;</span></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Proj_Name&quot;</span>, projectName)</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;File_Format&quot;</span>, <span class="stringliteral">&quot;Free&quot;</span>)</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Mesh_File_Format&quot;</span>, <span class="stringliteral">&quot;Large&quot;</span>)</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Edge_Point_Max&quot;</span>, 2);</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Edge_Point_Min&quot;</span>, 2);</div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Analysis_Type&quot;</span>, <span class="stringliteral">&quot;StaticOpt&quot;</span>);</div></div><!-- fragment --><p> The next update adds a material allowable to the material input <code>yieldAllow</code>. This is not a requirement for THIS optimization problem, but this input is referenced when design constraints are added later. </p><div class="fragment"><div class="line">madeupium    = {<span class="stringliteral">&quot;materialType&quot;</span> : <span class="stringliteral">&quot;isotropic&quot;</span>,</div><div class="line">                <span class="stringliteral">&quot;youngModulus&quot;</span> : 1.0E7 ,</div><div class="line">                <span class="stringliteral">&quot;poissonRatio&quot;</span> : .33,</div><div class="line">                <span class="stringliteral">&quot;density&quot;</span>      : 0.1,</div><div class="line">                <span class="stringliteral">&quot;yieldAllow&quot;</span>   : 5.6E7}</div><div class="line"></div><div class="line">nastranAIM.setAnalysisVal(<span class="stringliteral">&quot;Material&quot;</span>, [(<span class="stringliteral">&quot;Madeupium&quot;</span>, madeupium)])</div></div><!-- fragment --><p> The first large optimization input is the design variable definition section. For more information, the user is pointed to the <a class="el" href="feaDesignVariable.html">FEA DesignVariable</a> section. In this section the area of each rod element in the three bar truss is defined as a separate design variable. Finally each of these variables are used to defined AIM Input <code>Design_Variable</code> </p><div class="fragment"><div class="line">DesVar1    = {<span class="stringliteral">&quot;groupName&quot;</span> : <span class="stringliteral">&quot;bar1&quot;</span>,</div><div class="line">              <span class="stringliteral">&quot;initialValue&quot;</span> : rod[<span class="stringliteral">&quot;crossSecArea&quot;</span>],</div><div class="line">              <span class="stringliteral">&quot;lowerBound&quot;</span> : rod[<span class="stringliteral">&quot;crossSecArea&quot;</span>]*0.5,</div><div class="line">              <span class="stringliteral">&quot;upperBound&quot;</span> : rod[<span class="stringliteral">&quot;crossSecArea&quot;</span>]*1.5,</div><div class="line">              <span class="stringliteral">&quot;maxDelta&quot;</span>   : rod[<span class="stringliteral">&quot;crossSecArea&quot;</span>]*0.1,</div><div class="line">              <span class="stringliteral">&quot;fieldName&quot;</span> : <span class="stringliteral">&quot;A&quot;</span>}</div><div class="line"></div><div class="line">DesVar2    = {<span class="stringliteral">&quot;groupName&quot;</span> : <span class="stringliteral">&quot;bar2&quot;</span>,</div><div class="line">              <span class="stringliteral">&quot;initialValue&quot;</span> : rod2[<span class="stringliteral">&quot;crossSecArea&quot;</span>],</div><div class="line">              <span class="stringliteral">&quot;lowerBound&quot;</span> : rod2[<span class="stringliteral">&quot;crossSecArea&quot;</span>]*0.5,</div><div class="line">              <span class="stringliteral">&quot;upperBound&quot;</span> : rod2[<span class="stringliteral">&quot;crossSecArea&quot;</span>]*1.5,</div><div class="line">              <span class="stringliteral">&quot;maxDelta&quot;</span>   : rod2[<span class="stringliteral">&quot;crossSecArea&quot;</span>]*0.1,</div><div class="line">              <span class="stringliteral">&quot;fieldName&quot;</span> : <span class="stringliteral">&quot;A&quot;</span>}</div><div class="line"></div><div class="line">DesVar3    = {<span class="stringliteral">&quot;groupName&quot;</span> : <span class="stringliteral">&quot;bar3&quot;</span>,</div><div class="line">              <span class="stringliteral">&quot;initialValue&quot;</span> : rod[<span class="stringliteral">&quot;crossSecArea&quot;</span>],</div><div class="line">              <span class="stringliteral">&quot;lowerBound&quot;</span> : rod[<span class="stringliteral">&quot;crossSecArea&quot;</span>]*0.5,</div><div class="line">              <span class="stringliteral">&quot;upperBound&quot;</span> : rod[<span class="stringliteral">&quot;crossSecArea&quot;</span>]*1.5,</div><div class="line">              <span class="stringliteral">&quot;maxDelta&quot;</span>   : rod[<span class="stringliteral">&quot;crossSecArea&quot;</span>]*0.1,</div><div class="line">              <span class="stringliteral">&quot;fieldName&quot;</span> : <span class="stringliteral">&quot;A&quot;</span>}</div><div class="line"></div><div class="line">myProblem.analysis[<span class="stringliteral">&quot;nastran&quot;</span>].setAnalysisVal(<span class="stringliteral">&quot;Design_Variable&quot;</span>, [(<span class="stringliteral">&quot;Bar1A&quot;</span>, DesVar1),</div><div class="line">                                                                (<span class="stringliteral">&quot;Bar2A&quot;</span>, DesVar2),</div><div class="line">                                                                (<span class="stringliteral">&quot;Bar3A&quot;</span>, DesVar3)])</div></div><!-- fragment --><p> The next unique section is the addition of design constraints. In this problem stress constraints in each rod element are added. </p><div class="fragment"><div class="line">designConstraint1 = {<span class="stringliteral">&quot;groupName&quot;</span> : <span class="stringliteral">&quot;bar1&quot;</span>,</div><div class="line">                    <span class="stringliteral">&quot;responseType&quot;</span> : <span class="stringliteral">&quot;STRESS&quot;</span>,</div><div class="line">                    <span class="stringliteral">&quot;lowerBound&quot;</span> : -madeupium[<span class="stringliteral">&quot;yieldAllow&quot;</span>],</div><div class="line">                    <span class="stringliteral">&quot;upperBound&quot;</span> :  madeupium[<span class="stringliteral">&quot;yieldAllow&quot;</span>]}</div><div class="line"></div><div class="line">designConstraint2 = {<span class="stringliteral">&quot;groupName&quot;</span> : <span class="stringliteral">&quot;bar2&quot;</span>,</div><div class="line">                    <span class="stringliteral">&quot;responseType&quot;</span> : <span class="stringliteral">&quot;STRESS&quot;</span>,</div><div class="line">                    <span class="stringliteral">&quot;lowerBound&quot;</span> : -madeupium[<span class="stringliteral">&quot;yieldAllow&quot;</span>],</div><div class="line">                    <span class="stringliteral">&quot;upperBound&quot;</span> :  madeupium[<span class="stringliteral">&quot;yieldAllow&quot;</span>]}</div><div class="line"></div><div class="line">designConstraint3 = {<span class="stringliteral">&quot;groupName&quot;</span> : <span class="stringliteral">&quot;bar3&quot;</span>,</div><div class="line">                    <span class="stringliteral">&quot;responseType&quot;</span> : <span class="stringliteral">&quot;STRESS&quot;</span>,</div><div class="line">                    <span class="stringliteral">&quot;lowerBound&quot;</span> : -madeupium[<span class="stringliteral">&quot;yieldAllow&quot;</span>],</div><div class="line">                    <span class="stringliteral">&quot;upperBound&quot;</span> :  madeupium[<span class="stringliteral">&quot;yieldAllow&quot;</span>]}</div><div class="line"></div><div class="line">myProblem.analysis[<span class="stringliteral">&quot;nastran&quot;</span>].setAnalysisVal(<span class="stringliteral">&quot;Design_Constraint&quot;</span>,[(<span class="stringliteral">&quot;stress1&quot;</span>, designConstraint1),</div><div class="line">                                                                  (<span class="stringliteral">&quot;stress2&quot;</span>, designConstraint2),</div><div class="line">                                                                  (<span class="stringliteral">&quot;stress3&quot;</span>, designConstraint3)])</div></div><!-- fragment --><p> This completes the unique parts of the design inputs required for a Nastran optimization problem.</p>
<h1><a class="anchor" id="nastranCompositeEx"></a>
Composite Wing Example</h1>
<p>This example introduces the use of composite materials. Initially a composite wing frequency analysis is completed. This example will grow to introduce design optimization with composites, including design variable linking.</p>
<div class="image">
<img src="compositeWing.png" alt="compositeWing.png"/>
<div class="caption">
Composite Wing Example</div></div>
 <p>The CSM script generates Bodies which are designed to be used by specific AIMs. The AIMs that the Body is designed for is communicated to the CAPS framework via the “capsAIM” string attribute. This is a semicolon-separated string with the list of AIM names. Thus, the CSM author can give a clear indication to which AIMs should use the Body. In this example, the list contains the structural finite element analysis tools that can analyze the body: </p><div class="fragment"><div class="line">attribute capsAIM $nastranAIM;astrosAIM;mystranAIM</div></div><!-- fragment --><p> The parameter being set in this case is a definition for a coordinate system in Engineering Sketch Pad. The documentation for <code>csystem</code> inputs is as follows. </p><pre class="fragment">CSYSTEM   $csysName csysList
        use:    attach a Csystem to Body on top of stack
        pops:   any
        pushes: any
        notes:  Sketch may not be open
                if     csysList contains 9 entries:
                   {x0, y0, z0, dx1, dy1, dz1, dx2, dy2, dz2}
                   origin is at (x0,y0,q0)
                   dirn1  is in (dx1,dy1,dz1) direction
                   dirn2  is part of (dx2,dy2,dz2) that is orthog. to dirn1
                elseif csysList contains 5 entries and first is positive
                   {+iface, ubar0, vbar0, du2, dv2}
                   origin is at normalized (ubar0,vbar0) in iface
                   dirn1  is normal to Face
                   dirn2  is in (du2,dv2) direction
                elseif csysList contains 5 entries and first is negative
                   {-iedge, tbar, dx2, dy2, dz2}
                   origin is at normalized (tbar) in iedge
                   dirn1  is tangent to Edge
                   dirn2  is part of (dx2,dy2,dz2) that is orthog. to dirn1
                elseif csysList contains 7 entries
                   {inode, dx1, dy1, dz1, dx2, dy2, dz2}
                   origin is at Node inode
                   dirn1  is in (dx1,dy1,dz1) direction
                   dirn2  is part of (dx1,dy2,dz2) that is orthog. to dirn1
                else
                   error
                semicolon-sep lists can instead refer to
                   multi-valued Parameter
                dirn3 is formed by (dirn1)-cross-(dirn2)
                does not create a Branch
</pre><p>In the <code>compositesys</code> parameter defined below 9 entries are given. Based on the documentation above this indicates the following. </p><table class="doxtable">
<tr>
<td>Origin </td><td>0.0 </td><td>5.5 </td><td>0.0  </td></tr>
<tr>
<td>Vector along x-Axis </td><td>79.3685 </td><td>-0.65432 </td><td>0.0  </td></tr>
<tr>
<td>Vector along y-Axis </td><td>0.65432 </td><td>79.3685 </td><td>0.0  </td></tr>
</table>
<p>It should be noted that the vector along the y-axis may not be input perfectly perpendicular to the vector along the x-Axis. In this case ESP takes the projection of the input vector that is in the plane defined by both input vectors and perpendicular to the x-Axis. This is the case for all csystem input options defined above. </p><div class="fragment"><div class="line">dimension compositesys   9   1   0</div><div class="line">set       compositesys 0;5.5;0;79.3685;-0.65432;0;0.65432;79.3685;0</div></div><!-- fragment --><p> The geometry definition was generated by the ESP sketcher. Users are referred to ESP tutorials for information on how to create a sketch. The result is copy and pasted into the <code>*.csm</code> file snippet shown below. </p><div class="fragment"><div class="line">skbeg     0   0   0   1</div><div class="line">   skvar     xy   -0.024750;0.051384;4.841311;-0.024750;-3.895337;0.000000;82.067045;-3.895337;0.000000;77.594095;3.314007;0.000000;4.132462;13.891219;0.000000;-2.340160;13.680727;0.000000;-1.235078;10.891711;0.000000;</div><div class="line">   skcon     X   1   -1  0</div><div class="line">   skcon     Y   1   -1  0</div><div class="line">   skcon     V   1   2  0</div><div class="line">   skcon     L   3   4  8.5</div><div class="line">   skcon     R   7   1  5.5</div><div class="line">   skcon     H   2   3  0</div><div class="line">   skcon     L   1   2  3.91</div><div class="line">   skcon     L   6   7  3</div><div class="line">   skcon     L   5   6  6.5</div><div class="line">   skcon     L   4   5  74.2</div><div class="line">   skcon     L   2   3  82.1</div><div class="line">   skcon     P   1   -1  0</div><div class="line">   skcon     A   5   -1  10</div><div class="line">   skcon     A   6   -1  110</div><div class="line">   skcon     A   4   -1  50</div><div class="line">   linseg    ::x[2]   ::y[2]   0</div><div class="line">   linseg    ::x[3]   ::y[3]   0</div><div class="line">   linseg    ::x[4]   ::y[4]   0</div><div class="line">   linseg    ::x[5]   ::y[5]   0</div><div class="line">   linseg    ::x[6]   ::y[6]   0</div><div class="line">   linseg    ::x[7]   ::y[7]   0</div><div class="line">   arc       ::x[1]   ::y[1]   0   ::d[1]   xy</div><div class="line">skend     0</div></div><!-- fragment --><p> The root edges are marked as <code>capsConstraint</code> locations. The overall surfaces is given a <code>capsGroup</code> and <code>capsLoad</code> attribute and a <code>csystem</code> definition is attached to it using the <code>compositesys</code> parameter previously discussed. </p><div class="fragment"><div class="line">attribute capsGroup $wing</div><div class="line">attribute capsLoad  $wing</div><div class="line">attribute capsBound $wing</div><div class="line">csystem   wing   compositesys</div><div class="line">select    edge   7</div><div class="line">attribute capsConstraint   $root</div><div class="line">select    edge   6</div><div class="line">attribute capsConstraint   $root</div><div class="line">select    edge   1</div><div class="line">attribute capsConstraint   $root</div></div><!-- fragment --><p> This model was created in centimeters and is converted to inches. </p><div class="fragment"><div class="line">scale 1/2.54</div></div><!-- fragment --><p> Note if your Python major version is less than 3 (i.e. Python 2.7) the following statement should also be included so that print statements work correctly. </p><div class="fragment"></div><!-- fragment --><p> The following input defines a pyCAPS input that can be used along with the above *.csm input to create a nastran input. First the pyCAPS and os module needs to be imported. </p><div class="fragment"></div><!-- fragment --><p> Once the modules have been loaded the problem needs to be initiated. </p><div class="fragment"></div><!-- fragment --><p> Next the *.csm file is loaded. Though not shown in this example the user has access to the X, Y and Z despmtr inputs from this pyCAPS script. </p><div class="fragment"></div><!-- fragment --><p> The Nastran AIM is then loaded with: </p><div class="fragment"></div><!-- fragment --><p> After the AIM is loaded some of the inputs to the AIM are defined. A full list of options can be found in the <a class="el" href="aimInputsNastran.html">AIM Inputs</a> section. In this case the <code>Proj_Name</code> is entered. The project name becomes the Nastran input file names. Two are create <code>projectName.bdf</code> and <code>projectName.dat</code>. The <code>*.bdf</code> file contains the grid and connectivity information. The data file contains the case control and other bulk data inputs required by Nastran. The input format is selected as <code>Small</code> and <code>Large</code> field format is used when the option is available. This is most likely in the GRID entries only. Additionally, the analysis type selected is <code>Static</code>. The maximum points that can be placed along an edge is set to be 40. </p><div class="fragment"></div><!-- fragment --><p> In this example two materials are defined. This demonstrates how simple it is to change materials in a model. Both an aluminum and Graphite_expoxy material are defined in the <code>Material</code> <a class="el" href="aimInputsNastran.html">AIM Inputs</a>. </p><div class="fragment"></div><!-- fragment --><p> Again property information is defined for both an aluminum and composite stack version of the model. However, only the composite entry is defined in the <code>Property</code> <a class="el" href="aimInputsNastran.html">AIM Inputs</a>. <br />
</p>
<p>The <code>composite</code> definition brings together the materials in each layer of the stack, their thicknesses and orientations. For the sequence defined below the order of the sequence is given in the table below. The full sequence is given to point out that they symmetry condition is applied to the right side of the <code>compositeOrientation</code> input. </p><table class="doxtable">
<tr>
<td>0</td><td>0</td><td>0</td><td>0</td><td>-45</td><td>45</td><td>-45</td><td>45</td><td>45</td><td>-45</td><td>45</td><td>-45</td><td>0</td><td>0</td><td>0</td><td>0 </td></tr>
</table>
<p>Finally, the property is assigned to the regions with the <code>capsGroup $wing</code> attribute. </p><div class="fragment"></div><!-- fragment --><p> In this example the root edges are constrained in all degrees of freedom. This constraint references the <code>capsConstraint $root</code> input defined in the *.csm file. </p><div class="fragment"></div><!-- fragment --><p> As previously shown in <a class="el" href="examplesNastran.html#nastranModalEx">Modal Analysis Example Case</a> information to define an eigen value problem is entered and the <code>Analysis</code> AIM Input is defined. </p><div class="fragment"></div><!-- fragment --><p> Finally, preAnalysis is executed to generate all the required Nastran inputs. </p><div class="fragment"></div><!-- fragment --><p> Nastran is executed with a simple system call. </p><div class="fragment"></div><!-- fragment --><p> A post analysis command is entered allowing the user to access output data, if desired, from the application. </p><div class="fragment"></div><!-- fragment --><p> The caps session is closed. </p><div class="fragment"></div><!-- fragment --> <h1><a class="anchor" id="nastranCompOptimizationEx"></a>
Composite Wing Optimization Example</h1>
<p>This section removes the frequency analysis and adds a pressure load to the previously introduced composite wing example case. Then An optimization problem allowing the thickness of each ply layer to change is performed. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 28 2020 06:21:31 for Nastran Analysis Interface Module (AIM) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
